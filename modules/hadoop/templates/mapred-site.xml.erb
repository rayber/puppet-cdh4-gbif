<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<configuration>
  <property>
    <name>mapred.job.tracker</name>
    <value><%= jobtracker -%>:8021</value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.local.dir</name>
    <value><%= hadoop_disks.collect {|hadoop_disk| hadoop_disk + "/hadoop/mapreduce/local"}.join(',') -%></value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.system.dir</name>
    <value>/hadoop/mapred/system</value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.temp.dir</name>
    <value>/tmp/mapreduce</value>
  </property>

  <property>
    <name>mapreduce.jobtracker.staging.root.dir</name>
    <value>/user</value>
  </property>

  <property>
    <name>mapred.jobtracker.taskScheduler</name>
    <value>org.apache.hadoop.mapred.FairScheduler</value>
  </property>

  <property>
    <name>mapred.fairscheduler.allocation.file</name>
    <value>/etc/hadoop/conf/fair-scheduler.xml</value>
  </property>

  <property>
    <name>mapred.fairscheduler.assignmultiple</name>
    <value>true</value>
  </property>

  <property>
    <name>mapred.fairscheduler.sizebasedweight</name>
    <value>true</value>
  </property>

  <property>
    <name>mapred.map.tasks</name>
    <value>50</value>
  </property>

  <property>
    <name>mapred.reduce.tasks</name>
    <value>7</value>
  </property>

  <property>
    <name>mapred.tasktracker.map.tasks.maximum</name>
    <value><%= mapred_max_maps %></value>
    <final>true</final>
  </property>

  <property>
    <name>mapred.tasktracker.reduce.tasks.maximum</name>
    <value><%= mapred_max_reduces %></value>
    <final>true</final>
  </property>
  <property>
    <name>mapred.submit.replication</name>
    <value>3</value>
    <description> By default it is 10. We have to change it to 10 when we have more than 10 datanodes. Usually people set it to square root of number of data nodes.
    </description>
  </property>
  <property>
    <name>mapred.child.java.opts</name>
    <value>-Xmx<%= mapred_max_memory %>m</value>
  </property>

  <property>
    <name>mapred.hosts</name>
    <value>/etc/hadoop/conf/allowed_hosts</value>
  </property>

  <property>
    <name>mapred.hosts.exclude</name>
    <value>/etc/hadoop/conf/excluded_hosts</value>
  </property>

  <property>
    <name>mapred.tasktracker.expiry.interval</name>
    <value>180000</value>
  </property>

  <property>
    <name>mapred.compress.map.output</name>
    <value>true</value>
  </property>

  <property>
    <name>mapred.map.output.compression.codec</name>
    <value>org.apache.hadoop.io.compress.SnappyCodec</value>
  </property>

  <property>
    <name>mapred.output.compression.codec</name>
    <value>org.apache.hadoop.io.compress.SnappyCodec</value>
  </property>

  <property>
    <name>io.sort.factor</name>
    <value>100</value>
  </property>

  <property>
    <name>tasktracker.http.threads</name>
    <value>80</value>
    <final>true</final>
  </property>
  
  <property>
    <name>mapred.userlog.retain.hours</name>
    <value>72</value>
    <final>true</final>
  </property>

</configuration>
